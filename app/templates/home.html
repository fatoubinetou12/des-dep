{% extends "layout.html" %}
{% block title %}Accueil - DS Travel{% endblock %}

{% block content %}
<!-- ======== Banni√®re avec estimation ======== -->
<section class="text-white fullscreen-banner position-relative">
  <!-- Image en arri√®re-plan -->
  <img src="https://images.unsplash.com/photo-1503376780353-7e6692767b70?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80"
       alt="Voiture de luxe DS Travel"
       class="banner-background">

  <!-- Filtre sombre -->
  <div class="banner-overlay"></div>

  <!-- Contenu centr√© -->
  <div class="banner-content">
    <h1 class="display-4 fw-bold mb-3 animate__animated animate__fadeInDown">
      Voyagez avec style et s√©r√©nit√©
    </h1>
    <p class="lead mb-4 animate__animated animate__fadeInUp animate__delay-1s">
      Service VTC premium √† Dakar et vers l'a√©roport AIBD
    </p>

    <!-- Formulaire estimation -->
    <div class="estimation-form-container">
      <form method="POST" action="{{ url_for('main.estimation_trajet') }}" class="row g-2 justify-content-center">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <div class="col-md-4">
          <input type="text" id="depart" name="depart" class="form-control form-control-lg"
                 placeholder="üìç Adresse de d√©part" required>
        </div>
        <div class="col-md-4">
          <input type="text" id="arrivee" name="arrivee" class="form-control form-control-lg"
                 placeholder="üéØ Adresse d'arriv√©e" required>
        </div>
        <div class="col-md-2">
          <button type="submit" class="btn btn-warning btn-lg w-100 fw-bold">
            Estimer
          </button>
        </div>
      </form>

      <!-- R√©sultats de l'estimation -->
      {% if depart and arrivee %}
      <div id="estimation-box" class="estimation-result mt-4">
        <button type="button" class="btn-close btn-close-white position-absolute top-0 end-0 m-2"
                aria-label="Fermer"
                onclick="document.getElementById('estimation-box').style.display='none';"></button>

        <h4 class="mb-3">üìä Estimation de votre trajet</h4>
        <div class="row">
          <div class="col-md-6">
            <p><strong>üìç D√©part :</strong> {{ depart }}</p>
            <p><strong>üéØ Arriv√©e :</strong> {{ arrivee }}</p>
          </div>
          <div class="col-md-6">
            <p><strong>üìè Distance :</strong> {{ distance_km }} km</p>
            <p><strong>‚è±Ô∏è Temps :</strong> {{ temps_min }} min</p>
          </div>
        </div>
        <div class="text-center mt-3">
          <p class="fs-5 fw-bold text-warning mb-3">üí∞ Estimation : {{ tarif }}</p>
          <a href="#notre-flotte" class="btn btn-success btn-lg px-4">
            üöó R√©server maintenant
          </a>
        </div>
      </div>
      {% endif %}
    </div>

    <!-- Bouton ancre flotte -->
    <div class="mt-4">
      <a href="#notre-flotte" class="btn btn-outline-light btn-lg px-5 fw-bold">
        üëá Voir notre flotte
      </a>
    </div>
  </div>
</section>

<!-- ======== Sections principales ======== -->
<div class="container-fluid p-0">

  <!-- ======= Pourquoi choisir DS TRAVEL ======= -->
  <section class="py-5 bg-light">
    <div class="container">
      <div class="text-center mb-5">
        <h2 class="fw-bold display-5 mb-3">
          Pourquoi choisir <span class="text-success">DS TRAVEL</span> ?
        </h2>
        <p class="lead text-muted max-w-800 mx-auto">
          Forts de notre exp√©rience, nous garantissons un service de qualit√©,
          alliant ponctualit√©, s√©curit√© et confort. Notre priorit√© est votre satisfaction.
        </p>
      </div>

      <div class="row g-4">
        <!-- Services principaux -->
        <div class="col-lg-4">
          <div class="text-center p-4">
            <div class="icon-container mb-4">
              <i class="bi bi-airplane fs-1 text-success"></i>
            </div>
            <h4 class="fw-bold mb-3">Services principaux</h4>
            
            <div class="feature-item mb-4">
              <div class="text-warning fs-2 mb-2">
                <i class="bi bi-airplane"></i>
              </div>
              <h5>Transferts a√©roports et gares</h5>
              <p class="text-muted">R√©servez votre chauffeur pour l'a√©roport AIBD ou tout d√©placement longue distance.</p>
            </div>
            
            <div class="feature-item mb-4">
              <div class="text-warning fs-2 mb-2">
                <i class="bi bi-signpost-split"></i>
              </div>
              <h5>Trajets longue distance</h5>
              <p class="text-muted">D√©placements dans tout le S√©n√©gal, m√™me vers les villes les plus √©loign√©es.</p>
            </div>
            
            <div class="feature-item">
              <div class="text-warning fs-2 mb-2">
                <i class="bi bi-briefcase"></i>
              </div>
              <h5>D√©placements professionnels</h5>
              <p class="text-muted">Id√©al pour vos rendez-vous d'affaires, congr√®s et √©v√©nements officiels.</p>
            </div>
          </div>
        </div>

        <!-- Nos valeurs -->
        <div class="col-lg-4">
          <div class="text-center p-4">
            <div class="icon-container mb-4">
              <i class="bi bi-heart fs-1 text-success"></i>
            </div>
            <h4 class="fw-bold mb-3">Nos valeurs</h4>
            
            <div class="feature-item mb-4">
              <div class="text-warning fs-2 mb-2">
                <i class="bi bi-clock-history"></i>
              </div>
              <h5>Ponctualit√©</h5>
              <p class="text-muted">Des chauffeurs toujours √† l'heure pour vos d√©placements importants.</p>
            </div>
            
            <div class="feature-item mb-4">
              <div class="text-warning fs-2 mb-2">
                <i class="bi bi-heart"></i>
              </div>
              <h5>Service personnalis√©</h5>
              <p class="text-muted">Nous adaptons chaque trajet √† vos besoins sp√©cifiques.</p>
            </div>
            
            <div class="feature-item">
              <div class="text-warning fs-2 mb-2">
                <i class="bi bi-chat-dots"></i>
              </div>
              <h5>Assistance 24/7</h5>
              <p class="text-muted">Un support permanent pour vos r√©servations et questions.</p>
            </div>
          </div>
        </div>

        <!-- Nos engagements -->
        <div class="col-lg-4">
          <div class="text-center p-4">
            <div class="icon-container mb-4">
              <i class="bi bi-shield-check fs-1 text-success"></i>
            </div>
            <h4 class="fw-bold mb-3">Nos engagements</h4>
            
            <div class="feature-item mb-4">
              <div class="text-warning fs-2 mb-2">
                <i class="bi bi-cash-coin"></i>
              </div>
              <h5>Tarifs clairs et fixes</h5>
              <p class="text-muted">Le prix est convenu √† l'avance, sans frais cach√©s.</p>
            </div>
            
            <div class="feature-item mb-4">
              <div class="text-warning fs-2 mb-2">
                <i class="bi bi-shield-lock"></i>
              </div>
              <h5>S√©curit√©</h5>
              <p class="text-muted">Chauffeurs professionnels, v√©hicules v√©rifi√©s et assur√©s.</p>
            </div>
            
            <div class="feature-item">
              <div class="text-warning fs-2 mb-2">
                <i class="bi bi-cloud-sun"></i>
              </div>
              <h5>Confort optimal</h5>
              <p class="text-muted">V√©hicules r√©cents, climatis√©s, pour un trajet agr√©able.</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- ======= Prestations ======= -->
  <section class="py-5">
    <div class="container">
      <div class="text-center mb-5">
        <h2 class="fw-bold display-5 mb-3">NOS PRESTATIONS</h2>
        <p class="lead text-muted">D√©couvrez nos services sur mesure pour tous vos d√©placements</p>
      </div>

      <div class="row g-4">
        <div class="col-md-6">
          <div class="card-prestation">
            <div class="card-prestation-body">
              <h4 class="title">‚úàÔ∏è A√©roports</h4>
              <p class="text">Attente avec pancarte √† votre nom. Service VIP disponible.</p>
            </div>
            <div class="card-prestation-img">
              <img src="{{ url_for('static', filename='images/airoport.jpg') }}" alt="Service a√©roport DS Travel">
            </div>
          </div>
        </div>
        
        <div class="col-md-6">
          <div class="card-prestation">
            <div class="card-prestation-body">
              <h4 class="title">üè® H√¥tels</h4>
              <p class="text">Prise en charge directement √† la r√©ception de votre h√¥tel.</p>
            </div>
            <div class="card-prestation-img">
              <img src="{{ url_for('static', filename='images/hot.jpg') }}" alt="Service h√¥tels DS Travel">
            </div>
          </div>
        </div>
        
        <div class="col-md-6">
          <div class="card-prestation">
            <div class="card-prestation-body">
              <h4 class="title">üõ£Ô∏è Longue distance</h4>
              <p class="text">Dakar / Ziguinchor et toutes les r√©gions du S√©n√©gal.</p>
            </div>
            <div class="card-prestation-img">
              <img src="{{ url_for('static', filename='images/ldistance.jpg') }}" alt="Longue distance DS Travel">
            </div>
          </div>
        </div>
        
        <div class="col-md-6">
          <div class="card-prestation">
            <div class="card-prestation-body">
              <h4 class="title">üíº Professionnel</h4>
              <p class="text">RDV d'affaires, congr√®s et √©v√©nements professionnels.</p>
            </div>
            <div class="card-prestation-img">
              <img src="{{ url_for('static', filename='images/taxii.jpg') }}" alt="Service professionnel DS Travel">
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- ======= Notre flotte de v√©hicules ======= -->
  <section class="py-5 bg-light" id="notre-flotte">
    <div class="container">
      <div class="text-center mb-5">
        <h2 class="fw-bold display-5 mb-3">Notre flotte de v√©hicules</h2>
        <p class="lead text-muted max-w-800 mx-auto">
          Des v√©hicules r√©cents, confortables et parfaitement entretenus pour r√©pondre √† tous vos besoins.
        </p>
      </div>

      <div class="row g-4">
        {% for vehicule in vehicules %}
        <div class="col-xl-4 col-lg-6 mb-4">
          <div class="card vehicle-card h-100 shadow-sm border-0">
            <div class="card-img-container">
              <img src="{{ url_for('static', filename=vehicule.image or 'images/placeholder-vehicule.jpg') }}"
                   class="card-img-top"
                   alt="{{ vehicule.marque }} {{ vehicule.modele }} - DS Travel"
                   loading="lazy">
              <div class="card-img-overlay d-flex align-items-start justify-content-end">
                <span class="badge bg-success bg-opacity-90 fs-6">
                  üü¢ Disponible
                </span>
              </div>
            </div>

            <div class="card-body">
              <h3 class="card-title h5 text-success fw-bold mb-3">
                {{ vehicule.marque }} {{ vehicule.modele }}
              </h3>

              <div class="vehicle-features mb-4">
                <div class="feature-item">
                  <i class="bi bi-people-fill text-warning me-2"></i>
                  <span><strong>Passagers :</strong> {{ vehicule.capacite_passagers }}</span>
                </div>
                <div class="feature-item">
                  <i class="bi bi-suitcase text-warning me-2"></i>
                  <span><strong>Valises :</strong> {{ vehicule.nb_valises }}</span>
                </div>
                {% if vehicule.nb_sieges_bebe > 0 %}
                <div class="feature-item">
                  <i class="bi bi-bag-plus text-warning me-2"></i>
                  <span><strong>Si√®ges b√©b√© :</strong> {{ vehicule.nb_sieges_bebe }}</span>
                </div>
                {% endif %}
              </div>

              <div class="d-grid gap-2">
                <button class="btn btn-outline-success"
                        data-bs-toggle="modal"
                        data-bs-target="#vehiculeModal{{ vehicule.id }}">
                  üîç Voir les d√©tails
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Modal d√©tail v√©hicule -->
        <div class="modal fade" id="vehiculeModal{{ vehicule.id }}" tabindex="-1"
             aria-labelledby="vehiculeModalLabel{{ vehicule.id }}" aria-hidden="true">
          <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
              <div class="modal-header bg-success text-white">
                <h4 class="modal-title fw-bold" id="vehiculeModalLabel{{ vehicule.id }}">
                  üöó {{ vehicule.marque }} {{ vehicule.modele }}
                </h4>
                <button type="button" class="btn-close btn-close-white"
                        data-bs-dismiss="modal" aria-label="Fermer"></button>
              </div>

              <div class="modal-body">
                <div class="row g-4">
                  <div class="col-md-6">
                    <img src="{{ url_for('static', filename=vehicule.image or 'images/placeholder-vehicule.jpg') }}"
                         class="img-fluid rounded-3 shadow"
                         alt="{{ vehicule.marque }} {{ vehicule.modele }}">
                  </div>
                  <div class="col-md-6">
                    <div class="vehicle-details">
                      <h5 class="fw-bold text-success mb-3">üìã Caract√©ristiques</h5>
                      <ul class="list-unstyled">
                        <li class="mb-2"><strong>üöò Immatriculation :</strong> {{ vehicule.immatriculation }}</li>
                        <li class="mb-2"><strong>üìä Type :</strong> {{ vehicule.type }}</li>
                        <li class="mb-2"><strong>‚öôÔ∏è Caract√©ristiques :</strong> {{ vehicule.caracteristiques_techniques }}</li>
                        <li class="mb-2"><strong>üë• Passagers :</strong> {{ vehicule.capacite_passagers }}</li>
                        <li class="mb-2"><strong>üß≥ Valises :</strong> {{ vehicule.nb_valises }}</li>
                        <li class="mb-2"><strong>üì¶ Volume coffre :</strong> {{ vehicule.volume_coffre_bagages }} L</li>
                        {% if vehicule.volume_coffre_rabattus %}
                        <li class="mb-2"><strong>üìê Coffre rabattu :</strong> {{ vehicule.volume_coffre_rabattus }} L</li>
                        {% endif %}
                        {% if vehicule.nb_sieges_bebe > 0 %}
                        <li class="mb-2"><strong>üë∂ Si√®ges b√©b√© :</strong> {{ vehicule.nb_sieges_bebe }}</li>
                        {% endif %}
                        <li class="mb-2"><strong>üöó Coffre de toit :</strong> {% if vehicule.coffre_de_toit %}‚úÖ Oui{% else %}‚ùå Non{% endif %}</li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>

              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                  ‚úã Fermer
                </button>
                <a class="btn btn-success btn-lg px-4 fw-bold"
                   href="{{ url_for('main.reservation_page', vehicule_id=vehicule.id) }}">
                   üöó R√©server ce v√©hicule
                </a>
              </div>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
  </section>

  <!-- ======== Transferts Populaires ======== -->
  <section class="py-5">
    <div class="container">
      <div class="text-center mb-5">
        <h2 class="fw-bold display-5 mb-3 text-success">üöÄ Transferts Populaires</h2>
        <p class="lead text-muted">Nos trajets les plus demand√©s √† prix fixes</p>
      </div>

      <div class="row g-4">
        {% for t in transferts_populaires %}
        <div class="col-xl-3 col-lg-4 col-md-6">
          <div class="popular-transfer-card text-white h-100">
            <div class="card-body text-center p-4">
              <h5 class="card-title fw-bold mb-3">
                {{ t.depart }} <br> 
                <span class="text-warning">‚áÑ</span> <br> 
                {{ t.arrivee }}
              </h5>
              <p class="card-text display-6 fw-bold text-warning mb-3">
                {{ '{:,.0f}'.format(t.prix_cfa) }} FCFA
              </p>
              {% if t.distance_km %}
              <p class="mb-2 small opacity-75">üìè Distance : {{ t.distance_km }} km</p>
              {% endif %}
              <div class="mt-3">
                <span class="badge bg-warning text-dark">üí∞ Prix fixe</span>
              </div>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
  </section>

  <!-- ======== Section Transferts Cl√©s ======== -->
  <section class="key-transfers-section text-white position-relative">
    <img src="{{ url_for('static', filename='images/ba.jpg') }}"
         alt="Transferts S√©n√©gal DS Travel"
         class="transfer-background">
    <div class="transfer-overlay"></div>

    <div class="container position-relative py-5">
      <div class="row align-items-center">
        <div class="col-lg-8 mx-auto text-center">
          <h2 class="fw-bold display-5 mb-3">üåç Transferts Partout au S√©n√©gal</h2>
          <h3 class="text-warning mb-4 fs-3">A√©roport, Villes et Gares</h3>
          <p class="lead mb-5 opacity-75">
            Avec DS Travel, profitez d'un service fiable et confortable √† travers tout le S√©n√©gal.
            Que ce soit pour vos trajets depuis l'a√©roport AIBD, vos d√©placements vers les grandes villes,
            ou vos voyages vers les parcs touristiques, nous vous garantissons ponctualit√© et s√©curit√©.
          </p>

          <div class="row text-center stats-container">
            <div class="col-md-3 col-6 mb-4">
              <div class="stat-item p-3">
                <h3 class="text-warning display-6 fw-bold">1</h3>
                <p>A√©roport International<br>AIBD</p>
              </div>
            </div>
            <div class="col-md-3 col-6 mb-4">
              <div class="stat-item p-3">
                <h3 class="text-warning display-6 fw-bold">5+</h3>
                <p>Parcs Touristiques</p>
              </div>
            </div>
            <div class="col-md-3 col-6 mb-4">
              <div class="stat-item p-3">
                <h3 class="text-warning display-6 fw-bold">14</h3>
                <p>R√©gions Desservies</p>
              </div>
            </div>
            <div class="col-md-3 col-6 mb-4">
              <div class="stat-item p-3">
                <h3 class="text-warning display-6 fw-bold">10+</h3>
                <p>Gares Routi√®res</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</div>

<!-- ======== Google Places Autocomplete ======== -->
{% if google_key %}
<script src="https://maps.googleapis.com/maps/api/js?key={{ google_key }}&libraries=places&callback=initAutocomplete" async defer></script>
<script>
function initAutocomplete() {
  const depart = document.getElementById('depart');
  const arrivee = document.getElementById('arrivee');
  
  if (depart) {
    new google.maps.places.Autocomplete(depart, { 
      componentRestrictions: { country: "sn" },
      types: ['geocode']
    });
  }
  
  if (arrivee) {
    new google.maps.places.Autocomplete(arrivee, { 
      componentRestrictions: { country: "sn" },
      types: ['geocode']
    });
  }
}
</script>
{% endif %}

<!-- Bouton WhatsApp flottant -->
<a href="https://wa.me/221778602582" class="whatsapp-float" target="_blank" aria-label="Contactez-nous sur WhatsApp">
  <i class="bi bi-whatsapp"></i>
</a>

<style>
/* Styles pour la banni√®re */
.fullscreen-banner {
  height: 100vh;
  min-height: 600px;
}

.banner-background {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  z-index: 1;
}

.banner-overlay {
  position: absolute;
  inset: 0;
  background: linear-gradient(135deg, rgba(0, 100, 0, 0.7) 0%, rgba(0, 0, 0, 0.6) 100%);
  z-index: 2;
}

.banner-content {
  position: relative;
  z-index: 3;
  height: 100%;
  padding-top: 80px;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  text-align: center;
}

.estimation-form-container {
  background: rgba(0, 0, 0, 0.75);
  padding: 2rem;
  border-radius: 15px;
  width: 90%;
  max-width: 800px;
}

.estimation-result {
  background: rgba(108, 117, 125, 0.95);
  padding: 1.5rem;
  border-radius: 10px;
  position: relative;
}

/* Styles pour les cartes de v√©hicules */
.vehicle-card {
  transition: transform 0.3s ease, box-shadow 0.3s ease;
  border-radius: 15px;
  overflow: hidden;
}

.vehicle-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15) !important;
}

.card-img-container {
  position: relative;
  height: 220px;
  overflow: hidden;
}

.card-img-container img {
  height: 100%;
  object-fit: cover;
  transition: transform 0.3s ease;
}

.vehicle-card:hover .card-img-container img {
  transform: scale(1.05);
}

.vehicle-features .feature-item {
  display: flex;
  align-items: center;
  margin-bottom: 0.5rem;
}

/* Styles pour les transferts populaires */
.popular-transfer-card {
  background: linear-gradient(135deg, #006400 0%, #004d00 100%);
  border-radius: 15px;
  transition: transform 0.3s ease;
  border: none;
}

.popular-transfer-card:hover {
  transform: scale(1.05);
}

/* Styles pour la section transferts cl√©s */
.key-transfers-section {
  min-height: 80vh;
  display: flex;
  align-items: center;
}

.transfer-background {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  z-index: 1;
}

.transfer-overlay {
  position: absolute;
  inset: 0;
  background: rgba(0, 0, 0, 0.7);
  z-index: 2;
}

.stats-container .stat-item {
  background: rgba(255, 255, 255, 0.1);
  border-radius: 10px;
  backdrop-filter: blur(10px);
  transition: transform 0.3s ease;
}

.stats-container .stat-item:hover {
  transform: scale(1.05);
}

/* Styles pour les cartes de prestations */
.card-prestation {
  display: flex;
  justify-content: space-between;
  align-items: center;
  border: 1px solid #e9ecef;
  border-radius: 15px;
  overflow: hidden;
  background: #fff;
  transition: all 0.3s ease;
  height: 100%;
}

.card-prestation:hover {
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
  border-color: #006400;
}

.card-prestation-body {
  padding: 2rem;
  flex: 1;
}

.card-prestation-body .title {
  color: #006400;
  font-weight: 600;
  margin-bottom: 1rem;
  font-size: 1.25rem;
}

.card-prestation-body .text {
  color: #666;
  line-height: 1.6;
}

.card-prestation-img img {
  width: 200px;
  height: 150px;
  object-fit: cover;
  border-left: 1px solid #e9ecef;
}

/* Styles g√©n√©raux */
.max-w-800 {
  max-width: 800px;
}

.icon-container {
  width: 80px;
  height: 80px;
  background: rgba(0, 100, 0, 0.1);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 0 auto 1.5rem;
}

.feature-item {
  margin-bottom: 2rem;
}

.whatsapp-float {
  position: fixed;
  bottom: 25px;
  right: 25px;
  background-color: #25D366;
  color: white;
  border-radius: 50%;
  padding: 16px;
  font-size: 28px;
  z-index: 1000;
  box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
  transition: all 0.3s ease;
  text-decoration: none;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 60px;
  height: 60px;
}

.whatsapp-float:hover {
  background-color: #1ebe5c;
  transform: scale(1.1);
  color: white;
}

/* Responsive */
@media (max-width: 768px) {
  .display-4 {
    font-size: 2rem;
  }
  
  .estimation-form-container {
    width: 95%;
    padding: 1.5rem;
  }
  
  .card-prestation {
    flex-direction: column;
  }
  
  .card-prestation-img img {
    width: 100%;
    border-left: none;
    border-top: 1px solid #e9ecef;
  }
  
  .banner-content {
    padding-top: 100px;
  }
}
</style>
{% endblock %}
